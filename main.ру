import os
import asyncio
import threading
from telethon import TelegramClient, events
from http.server import SimpleHTTPRequestHandler, HTTPServer

# --- 1. БЛОК ДЛЯ RENDER (ЧТОБЫ НЕ ПАДАЛ) ---
def run_dummy_server():
    port = int(os.environ.get("PORT", 8080))
    server = HTTPServer(('', port), SimpleHTTPRequestHandler)
    print(f"--- WEB-ЗАГЛУШКА РАБОТАЕТ НА ПОРТУ {port} ---")
    server.serve_forever()

threading.Thread(target=run_dummy_server, daemon=True).start()

# --- 2. НАСТРОЙКИ БОТА (ВРЕМЕННЫЕ) ---
# Когда получишь реальные данные, замени их здесь:
API_ID = 21474836  # Это пример ID (заменишь на свой)
API_HASH = 'a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6' # Это пример Hash

# Ключевые слова для поиска "денег" в чатах дизайна
KEYWORDS = ['дизайн', 'логотип', 'лого', 'превью', 'баннер', 'инфографика', 'tilda', 'оформить']

client = TelegramClient('aharon_session', API_ID, API_HASH)

@client.on(events.NewMessage)
async def handler(event):
    msg = event.message.message.lower()
    if any(word in msg for word in KEYWORDS):
        print(f"--- НАЙДЕН ПОТЕНЦИАЛЬНЫЙ ЗАКАЗ! ---")
        # Здесь будет логика пересылки тебе в личку

async def start_bot():
    try:
        await client.start()
        print("--- ВИРТУАЛЬНАЯ РУКА В СЕТИ И ИЩЕТ ЗАКАЗЫ ---")
        await client.run_until_disconnected()
    except Exception as e:
        print(f"ОШИБКА: {e}")
        print("Это нормально! Нужно дождаться разблокировки и вставить реальные API
