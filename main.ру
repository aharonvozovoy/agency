import os
import asyncio
import threading
import re
from http.server import HTTPServer, BaseHTTPRequestHandler
from telethon import TelegramClient, events
from neonize.client import NewClient
from neonize.events import MessageEv

# --- 1. –°–ï–†–í–ï–† –î–õ–Ø RENDER (–ß—Ç–æ–±—ã —Å—Ç–∞—Ç—É—Å –±—ã–ª Live) ---
class HealthCheckHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.end_headers()
        self.wfile.write(b"Aaron System is Active and Waiting")

def run_health_server():
    port = int(os.environ.get("PORT", 8080))
    server = HTTPServer(('0.0.0.0', port), HealthCheckHandler)
    server.serve_forever()

# --- 2. –ù–ê–°–¢–†–û–ô–ö–ò (–¢–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ) ---
API_ID = 30893125
API_HASH = '5c73de68f3152f0513292cb495071e0b'
PHONE = '66618169428'

tg_client = TelegramClient('aaron_session', API_ID, API_HASH)
wa_client = NewClient("db.sqlite3")

# --- 3. –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê (–¢–æ—á–∫–∏, –î–µ–Ω—å–≥–∏, –ë–∞–π–∫–∏) ---
stats = {
    "tg_in": 0, "wa_in": 0,
    "dots_count": 0,
    "money_thb": 0, "money_usd": 0,
    "bikes_found": 0
}

def get_ai_level():
    total = stats["tg_in"] + stats["wa_in"]
    if total < 15: return "‚ö° –£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑"
    if total < 50: return "üî• –£—Ä–æ–≤–µ–Ω—å 2: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π (–°–¥–µ–ª–∫–∏)"
    return "üíé –£—Ä–æ–≤–µ–Ω—å 3: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ò–ò (–§–∏–Ω-–∫–æ–Ω—Ç—Ä–æ–ª—å)"
