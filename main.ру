import os
import asyncio
from telethon import TelegramClient, events
from telethon.sessions import StringSession

# –¢–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–æ—à–ª—ã—Ö —á–∞—Ç–æ–≤
API_ID = 30893125
API_HASH = '5c73de68f3152f0513292cb495071e0b'
# –≠—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –º—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –¥–æ–±–∞–≤–∏–ª–∏ –≤ Render
SESSION_STR = os.environ.get('TELEGRAM_STRING_SESSION')

client = TelegramClient(StringSession(SESSION_STR), API_ID, API_HASH)

# –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤-–º–∞—è—á–∫–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞ –±–∞–±–æ–∫ (–∞—Ä–±–∏—Ç—Ä–∞–∂–∞)
KEYWORDS = ['–Ω—É–∂–µ–Ω', '–∑–∞–∫–∞–∑', '–¥–∏–∑–∞–π–Ω', '–ª–æ–≥–æ—Ç–∏–ø', '—Å–∞–π—Ç', '–≤–µ—Ä—Å—Ç–∫–∞', '—Å–¥–µ–ª–∞—Ç—å']

@client.on(events.NewMessage)
async def handler(event):
    text = event.raw_text.lower()
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
    if any(word in text for word in KEYWORDS):
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–±–µ –≤ "–ò–∑–±—Ä–∞–Ω–Ω–æ–µ"
        chat_info = f"–ß–∞—Ç: {event.chat.title}" if event.chat else "–õ–∏—á–∫–∞"
        link = f"https://t.me/c/{event.chat_id}/{event.id}" if event.chat_id else "–ù–µ—Ç —Å—Å—ã–ª–∫–∏"
        
        await client.send_message('me', 
            f"üí∞ **–ù–ê–ô–î–ï–ù –ó–ê–ö–ê–ó!**\n\n"
            f"üìç {chat_info}\n"
            f"üìù {event.raw_text[:300]}...\n\n"
            f"üîó {link}\n"
            f"üìà *–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: –¥–æ–Ω–∞—Ç 10% –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ —Å–∏—Å—Ç–µ–º—ã!*")

async def main():
    await client.start()
    print("‚úÖ –°–ò–°–¢–ï–ú–ê –ó–ê–ü–£–©–ï–ù–ê. –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò–î–ï–¢...")
    await client.run_until_disconnected()

if __name__ == '__main__':
    asyncio.run(main())
